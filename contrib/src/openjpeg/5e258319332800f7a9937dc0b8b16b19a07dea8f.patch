From 5e258319332800f7a9937dc0b8b16b19a07dea8f Mon Sep 17 00:00:00 2001
From: Kai Pastor <dg0yt@darc.de>
Date: Fri, 26 Sep 2025 06:15:15 +0200
Subject: [PATCH] Fix pkgconfig 'deps' generation

---
 CMakeLists.txt | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 29a899393..7403e1891 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -332,10 +332,14 @@ set_variable_from_rel_or_absolute_path("includedir" "\\\${prefix}" "${CMAKE_INST
 function(get_pkgconfig_deps NAME OUT)
   get_target_property(link_libs ${NAME} LINK_LIBRARIES)
   if(NOT link_libs STREQUAL "link_libs-NOTFOUND")
-    foreach(lib ${link_libs})
-      # omit -lopenjp2 from Libs.private because libopenjp2 is in Requires
-      if(NOT ${lib} STREQUAL ${OPENJPEG_LIBRARY_NAME})
-        string(APPEND deps "-l${lib} ")
+    # omit openjp2 from Libs.private because libopenjp2 is in Requires
+    list(REMOVE_ITEM link_libs "${OPENJPEG_LIBRARY_NAME}")
+    set(deps "")
+    foreach(item IN LISTS link_libs)
+      if(item STREQUAL "-pthread")
+        string(APPEND deps " ${item}")
+      else()
+        string(APPEND deps " -l${item}")
       endif()
     endforeach()
   endif()
